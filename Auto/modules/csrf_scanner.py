from utils.http_requests import send_request


def scan_csrf(url):
    print(f"Scanning for CSRF vulnerabilities on {url}")
    # Giả định rằng ta kiểm tra CSRF bằng cách xem form có token CSRF hay không
    response = send_request(url)
    vulnerabilities = []

    if "csrf" not in response.text.lower():
        vulnerabilities.append({
            'type': 'CSRF',
            'severity': 'Medium',
            'description': 'No CSRF token found in forms.'
        })

    return {'vulnerabilities': vulnerabilities, 'duration': 5}
